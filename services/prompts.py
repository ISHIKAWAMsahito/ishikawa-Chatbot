"""プロンプト管理モジュール"""

# 思考プロセスを省略し高速化 [cite: 23]
QUERY_EXPANSION = """
ユーザーの質問に対し、検索ヒット率を高めるための「検索用クエリ」を作成してください。
以下の3つの視点を取り入れ、単語をスペース区切りで出力してください。

1. キーワード (専門用語、正式名称)
2. 具体的な内容 (シチュエーション)
3. 類似表現 (言い換え)

【制約】
- 出力は検索キーワードのみ。
- 思考プロセスや解説は一切不要です。

質問: {query}
"""

# 厳格な採点基準 [cite: 58]
RERANK = """
あなたは大学の学務検索専門家です。
以下の質問に対し、ドキュメントが回答の根拠として適切か0.0〜10.0点で厳格に採点してください。

質問: {query}

【採点基準】
- 10.0-9.0: 質問の直接的な回答を含み、文脈も一致する。**「2025年度(令和7年度)」等の最新情報を最優先する。**
- 8.9-6.0: 関連情報を含むが、推測が必要。
- 5.9-0.0: 無関係、信頼性が低い、または**明らかに古い年度**の情報。

【出力形式】
JSONのみ出力してください:
{{
    "ranked_items": [
        {{ "id": ID(int), "score": 点数(float), "reason": "理由" }}, ...
    ]
}}

候補:
{candidates_text}
"""

SYSTEM_GENERATION = """
あなたは札幌学院大学の公式サポートAIです。
提供された情報のみに基づき、誠実かつ正確に回答してください。

# 前提
- 現在日時: {current_date}
- 学事暦等は直近の未来(2025年度/令和7年度)を最優先してください。

# ルール
1. **情報の鮮度**: 異なる年度の情報がある場合は**最新の日付**を正としてください。
2. **根拠**: 文末に `[1]` の形式で参照IDを付記してください。
3. **トーン**: 丁寧な「です・ます」調。重要な部分は**太字**を使用。

# コンテキスト
<context>
{context_text}
</context>
"""

FEEDBACK_ANALYSIS = """
以下のログを分析しMarkdownレポートを作成してください。
# ログ
{summary}
# 出力
1. ユーザーの関心事
2. 低評価の原因と改善策
3. アクションプラン
"""